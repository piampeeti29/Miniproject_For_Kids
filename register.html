<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.5/dist/sweetalert2.all.min.js"></script>

    <link rel="stylesheet" href="/csskids.css">
</head>

<body id="body">

    <button class="btn " type="button" id="bbal">
        <img src="./public/img/back.png" alt="home" width="40em" id="home">
    </button>

    <div class="login_box" id="loginregister">

        <center>
            <h1 id="aregis">REGISTER</h1>
        </center>

        <div class="text">
            <form id="formregis">
                <input type="text" id="inre" name="Firstname" placeholder="Firstname">
                <input type="text" id="inre1" name="Lastname" placeholder="Lastname">
                <div class="row" id="lll">
                    <div class="col-sm-7"><input type="text" id="inre2" name="StudentID" placeholder="Student ID"></div>
                    <div class="col-sm-2"><label for="course" id="lt">Grade</label></div>
                    <div class="col-sm-1"><select name="course" id="lessonselect2">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>

                        </select></div>
                </div>



                <input type="text" id="inregis1" name="username" placeholder="Username">
                <input type="password" id="inregis" name="password" placeholder="Password"><br>
                <center><button type="submit" id="submitregis">SIGN UP</button></center>
            </form>


        </div>


    </div>



</body>
<script>

    document.querySelector('#bbal').onclick = function () {
        location.assign('/');
    }
    const formRegis = document.querySelector('#formregis');
    formRegis.onsubmit = function (e) {
        e.preventDefault();
        // get login form            
        // get username and password
        const fname = formRegis.elements['Firstname'].value;
        const lname = formRegis.elements['Lastname'].value;
        const sid = formRegis.elements['StudentID'].value;
        const user = formRegis.elements['username'].value;
        const pass = formRegis.elements['password'].value;
        const grade = document.querySelector('#lessonselect2');

        // console.log(grade);

        if (fname == '' ) {
            Swal.fire({
                title: 'กรอกให้เสร็จก่อนนะเธอ',
                width: 600,
                padding: '3em',
                color: '#716add',
                backdrop: `
                        rgba(0,0,123,0.4)
                        url("./public/img/adele.gif")
                        top
                        no-repeat
                        `
            })

        }
        else if (lname == ''){
            Swal.fire({
                title: 'กรอกให้เสร็จก่อนนะเธอ',
                width: 600,
                padding: '3em',
                color: '#716add',
                backdrop: `
                        rgba(0,0,123,0.4)
                        url("./public/img/adele.gif")
                        top
                        no-repeat
                        `
            })
        }

        else if (sid == ''){
            Swal.fire({
                title: 'กรอกให้เสร็จก่อนนะเธอ',
                width: 600,
                padding: '3em',
                color: '#716add',
                backdrop: `
                        rgba(0,0,123,0.4)
                        url("./public/img/adele.gif")
                        top
                        no-repeat
                        `
            })
        }


        else if (user == ''){
            Swal.fire({
                title: 'กรอกให้เสร็จก่อนนะเธอ',
                width: 600,
                padding: '3em',
                color: '#716add',
                backdrop: `
                        rgba(0,0,123,0.4)
                        url("./public/img/adele.gif")
                        top
                        no-repeat
                        `
            })
        }

        else if (pass == ''){Swal.fire({
                title: 'กรอกให้เสร็จก่อนนะเธอ',
                width: 600,
                padding: '3em',
                color: '#716add',
                backdrop: `
                        rgba(0,0,123,0.4)
                        url("./public/img/adele.gif")
                        top
                        no-repeat
                        `
            })}

            else {
            const options = {
                method: 'PUT',
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ "fname": fname, "lname": lname, "sid": sid, "user": user, "pass": pass, "grade": grade.value }),
            }
            fetch('/regis', options)
                .then(function (response) {
                    if (response.ok) {
                        return response.text();
                    }
                    throw Error("Wrong username or password");
                })
                .then(function (data) {
                    // forward to welcome page
                    location.replace(data);
                })
                .catch(function (error) {
                    Swal.fire({
                        "icon": "error",
                        "title": error
                    })
                });
        }
    }






</script>

</html>